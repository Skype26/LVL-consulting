<div class="p-6">
    <!-- Header -->
    <div class="mb-6 flex items-center justify-between">
        <div>
            <h1 class="text-2xl font-bold text-indigo-900 mb-2">Nuevo formulario</h1>
            <p class="text-sm text-gray-600">Complete sus datos y continúe con los siguientes pasos.</p>
        </div>
        <div class="flex gap-3">
            <button (click)="showContactFormModal.set(true)"
                class="flex items-center gap-2 px-6 py-3 bg-white border-2 border-indigo-900 text-indigo-900 rounded-lg hover:bg-indigo-50 transition">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                Configurar formulario
            </button>
            <button (click)="onSubmit()" [disabled]="form.invalid"
                class="flex items-center gap-2 px-6 py-3 bg-indigo-900 text-white rounded-lg hover:bg-indigo-800 transition disabled:opacity-50 disabled:cursor-not-allowed">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                </svg>
                Guardar
            </button>
        </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading()" class="flex items-center justify-center h-64">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-900"></div>
    </div>

    <!-- Form -->
    <div *ngIf="!loading()" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Left Column - Form Fields -->
        <div class="lg:col-span-2 bg-white rounded-lg shadow p-6">
            <form [formGroup]="form" class="space-y-6">
                <!-- Category Names Row -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Nombre de categoría<span class="text-red-500">*</span>
                        </label>
                        <input type="text" formControlName="categoryName1" placeholder="Introducir la categoría"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />
                        <div *ngIf="form.get('categoryName1')?.invalid && form.get('categoryName1')?.touched"
                            class="text-red-500 text-xs mt-1">
                            Este campo es requerido
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Nombre de categoría<span class="text-red-500">*</span>
                        </label>
                        <input type="text" formControlName="categoryName2" placeholder="Introducir la categoría"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />
                    </div>
                </div>

                <!-- Company -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Empresa<span class="text-red-500">*</span>
                    </label>
                    <select formControlName="company"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition appearance-none bg-white">
                        <option value="">Seleccionar una empresa</option>
                        <option *ngFor="let company of companies()" [value]="company.id">
                            {{ company.name }}
                        </option>
                    </select>
                </div>

                <!-- Company Types Row -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Tipo de empresa
                        </label>
                        <select formControlName="companyType1"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition appearance-none bg-white">
                            <option value="">Seleccionar tipo de empresa</option>
                            <option *ngFor="let type of companyTypes()" [value]="type.id">
                                {{ type.name }}
                            </option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Tipo de empresa
                        </label>
                        <select formControlName="companyType2"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition appearance-none bg-white">
                            <option value="">Seleccionar tipo de empresa</option>
                            <option *ngFor="let type of companyTypes()" [value]="type.id">
                                {{ type.name }}
                            </option>
                        </select>
                    </div>
                </div>

                <!-- Description -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Descripción
                    </label>
                    <textarea formControlName="description" rows="6"
                        placeholder="Escribe una descripción para la categoría"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition resize-none"></textarea>
                    <div *ngIf="form.get('description')?.invalid && form.get('description')?.touched"
                        class="text-red-500 text-xs mt-1">
                        La descripción debe tener al menos 10 caracteres
                    </div>
                </div>
            </form>
        </div>

        <!-- Right Column - File Upload -->
        <div class="rounded-lg shadow p-6 flex flex-col border border-gray-200 bg-gray-100">
            <h3 class=" text-lg font-semibold text-gray-900 mb-4">Documentos</h3>
            <div class="mt-25 flex-col p-6 text-center justify-center items-center">
                <input type="file" id="fileInput" (change)="onFileSelected($event)" accept="image/*,.pdf"
                    class="hidden" />

                <div *ngIf="!previewUrl()" class="flex flex-col items-center justify-center space-y-4">
                    <svg width="200" height="40" viewBox="0 0 20 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M0 3.27273C0 1.46525 1.46525 0 3.27273 0H12.1872C13.0551 0 13.8876 0.344804 14.5013 0.95856L18.6778 5.13503C19.2915 5.74879 19.6364 6.58121 19.6364 7.4492V20.7273C19.6364 22.5348 18.1712 24 16.3636 24H3.27273C1.46525 24 0 22.5348 0 20.7273V3.27273ZM3.27273 2.18182C2.67024 2.18182 2.18182 2.67024 2.18182 3.27273V20.7273C2.18182 21.3298 2.67024 21.8182 3.27273 21.8182H16.3636C16.9661 21.8182 17.4545 21.3298 17.4545 20.7273V8.72727H14.1818C12.3743 8.72727 10.9091 7.26202 10.9091 5.45455V2.18182H3.27273ZM13.0909 2.63368L17.0027 6.54545H14.1818C13.5793 6.54545 13.0909 6.05703 13.0909 5.45455V2.63368ZM9.0468 11.2286C9.4728 10.8026 10.1636 10.8026 10.5896 11.2286L13.8623 14.5013C14.2883 14.9273 14.2883 15.6181 13.8623 16.0441C13.4363 16.4701 12.7455 16.4701 12.3195 16.0441L10.9091 14.6337V18.5455C10.9091 19.148 10.4207 19.6364 9.81818 19.6364C9.21567 19.6364 8.72727 19.148 8.72727 18.5455V14.6337L7.31685 16.0441C6.89082 16.4701 6.20009 16.4701 5.77406 16.0441C5.34804 15.6181 5.34804 14.9273 5.77406 14.5013L9.0468 11.2286Z"
                            fill="#A5C5F0" />
                    </svg>

                    <label for="fileInput"
                        class="cursor-pointer inline-block px-6 py-3 bg-indigo-900 text-white rounded-lg hover:bg-indigo-800 transition">
                        Seleccionar archivos
                    </label>
                    <p class="text-xs text-gray-500 mt-3">o arrastre y suelte los PDF aquí</p>
                </div>

                <div *ngIf="previewUrl()" class="space-y-4">
                    <img [src]="previewUrl()" alt="Preview" class="max-w-full h-48 mx-auto object-cover rounded">
                    <div class="flex gap-2 justify-center">
                        <label for="fileInput"
                            class="cursor-pointer px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition text-sm">
                            Cambiar archivo
                        </label>
                        <button (click)="previewUrl.set(null); selectedFile.set(null)"
                            class="px-4 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition text-sm">
                            Eliminar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Formulario de Contacto -->
    <div *ngIf="showContactFormModal()"
        class="fixed inset-0 bg-black-50 backdrop-blur-lg flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <!-- Header del Modal -->
            <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between">
                <h2 class="text-xl font-bold text-gray-900">Formulario de contacto</h2>
                <button (click)="showContactFormModal.set(false)" class="text-gray-400 hover:text-gray-600 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- Contenido del Modal -->
            <div class="px-6 py-4 space-y-6">
                <!-- Nombre del formulario -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Nombre de formulario
                    </label>
                    <input type="text" placeholder="Introducir nombre del formulario"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                </div>

                <!-- Administrador -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 mb-2">Administrador</h3>
                    <p class="text-xs text-gray-600 mb-4">Seleccione los campos que desea incluir en el formulario de
                        contacto.</p>

                    <!-- Tabla de campos -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-700">Campo</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-gray-700">Mostrar</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-gray-700">Obligatorio</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <!-- Nombres y apellidos -->
                                <tr>
                                    <td class="px-4 py-3 text-sm text-gray-900">Nombres y apellidos</td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="checkbox" checked
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500" />
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer">
                                            <div
                                                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-900">
                                            </div>
                                        </label>
                                    </td>
                                </tr>

                                <!-- Número de teléfono -->
                                <tr>
                                    <td class="px-4 py-3 text-sm text-gray-900">Número de teléfono</td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="checkbox"
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500" />
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer">
                                            <div
                                                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-900">
                                            </div>
                                        </label>
                                    </td>
                                </tr>

                                <!-- Correo electrónico -->
                                <tr>
                                    <td class="px-4 py-3 text-sm text-gray-900">Correo electrónico</td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="checkbox"
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500" />
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div
                                                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-900">
                                            </div>
                                        </label>
                                    </td>
                                </tr>

                                <!-- Nombre de empresa -->
                                <tr>
                                    <td class="px-4 py-3 text-sm text-gray-900">Nombre de empresa</td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="checkbox" checked
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500" />
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div
                                                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-900">
                                            </div>
                                        </label>
                                    </td>
                                </tr>

                                <!-- País -->
                                <tr>
                                    <td class="px-4 py-3 text-sm text-gray-900">País</td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="checkbox" checked
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500" />
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div
                                                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-900">
                                            </div>
                                        </label>
                                    </td>
                                </tr>

                                <!-- Mensaje -->
                                <tr>
                                    <td class="px-4 py-3 text-sm text-gray-900">Mensaje</td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="checkbox" checked
                                            class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500" />
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div
                                                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-900">
                                            </div>
                                        </label>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Mensaje de agradecimiento -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Mensaje de agradecimiento
                    </label>
                    <input type="text" placeholder="¡Gracias!"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                </div>

                <!-- Términos y condiciones personalizados -->
                <div>
                    <div class="flex items-center justify-between mb-2">
                        <label class="text-sm font-medium text-gray-700">
                            Términos y condiciones personalizados
                        </label>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" checked class="sr-only peer">
                            <div
                                class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-900">
                            </div>
                        </label>
                    </div>
                    <input type="text" placeholder="https:// Añadir enlace"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                </div>
            </div>

            <!-- Footer del Modal -->
            <div class="sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4">
                <button (click)="showContactFormModal.set(false)"
                    class="w-full px-6 py-3 bg-indigo-900 text-white rounded-lg hover:bg-indigo-800 transition font-medium">
                    Crear formulario
                </button>
            </div>
        </div>
    </div>
</div>